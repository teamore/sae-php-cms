{% extends "base.html" %}
{% block script %}
    <script>
        async function sendPostLikeRequest(id, action = "like") {
            console.log("send like request for post #id "+id);
            fetch('?post_id='+id, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({"action": action})
            }).then((response)=>{
                window.location = window.location.href;
            });
        }
    </script>
{% endblock %}

{% block title %}{{result.title}}{% endblock %}
{% block content %}
    <table>
        {% for key, value in result %}
            <tr>
                <td>{{key}}</td>
                <td>{{value}}</td>
            </tr>
        {% endfor %}
    </table>
    <div>
        {% if result.ilike %}
        <button onclick="sendPostLikeRequest({{result.id}}, 'unlike');">unlike</button>
        {% else %}
            <button onclick="sendPostLikeRequest({{result.id}});">like</button>
        {% endif %}
    </div>
{% endblock %}
